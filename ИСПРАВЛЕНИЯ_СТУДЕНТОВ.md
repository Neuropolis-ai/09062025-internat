# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤

## üìã –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–ü—Ä–æ–±–ª–µ–º—ã —Å CORS**
- Backend –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è `http://localhost:3000`
- Frontend —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –ø–æ—Ä—Ç—É 3002, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ CORS –æ—à–∏–±–∫–∏ –≤ Chrome
- Chrome –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ CORS –ø–æ–ª–∏—Ç–∏–∫–∞–º

### 2. **–ü—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫**
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ API –∫–ª–∏–µ–Ω—Ç–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ù–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### 3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CORS –Ω–∞—Å—Ç—Ä–æ–µ–∫**
```typescript
// backend/lyceum-backend/src/main.ts
app.enableCors({
  origin: process.env.CORS_ORIGIN?.split(',') || [
    'http://localhost:3000',
    'http://localhost:3002', 
    'http://localhost:3003'
  ],
  credentials: process.env.CORS_CREDENTIALS === 'true',
});
```

### 2. **–£–ª—É—á—à–µ–Ω–∏–µ API –∫–ª–∏–µ–Ω—Ç–∞**
```typescript
// admin-web/src/lib/api.ts
private async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {
  // –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
  console.log(`API Request: ${config.method || 'GET'} ${url}`, config.body ? JSON.parse(config.body as string) : '');
  
  // –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  if (!response.ok) {
    const errorText = await response.text();
    let errorMessage = `API Error: ${response.status} ${response.statusText}`;
    
    try {
      const errorData = JSON.parse(errorText);
      errorMessage += ` - ${errorData.message || errorData.error || errorText}`;
    } catch {
      errorMessage += ` - ${errorText}`;
    }
    
    throw new Error(errorMessage);
  }
  
  // –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
  console.log(`API Response: ${config.method || 'GET'} ${url}`, result);
}
```

### 3. **–£–ª—É—á—à–µ–Ω–∏–µ AdminContext**
```typescript
// admin-web/src/contexts/AdminContext.tsx
const createUser = async (userData: any) => {
  try {
    setLoading(true);
    setError(null);
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const newUser = await apiClient.register({
      email: userData.email,
      password: 'LyceumPassword123!', // Default password
      firstName: userData.firstName,
      lastName: userData.lastName,
      role: userData.role || 'STUDENT',
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    await loadUsers();
    
    console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω:', newUser);
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', err);
    setError('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ' + (err instanceof Error ? err.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
    throw err;
  } finally {
    setLoading(false);
  }
};
```

### 4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫**
```typescript
// admin-web/src/app/students/page.tsx
{error && (
  <div className="mb-4 p-4 bg-red-50 border border-red-200 rounded-md">
    <div className="flex">
      <div className="flex-shrink-0">
        <span className="text-red-400">‚ö†Ô∏è</span>
      </div>
      <div className="ml-3">
        <h3 className="text-sm font-medium text-red-800">–û—à–∏–±–∫–∞</h3>
        <div className="mt-2 text-sm text-red-700">
          {error}
        </div>
      </div>
    </div>
  </div>
)}
```

### 5. **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤**
```typescript
// admin-web/src/app/students/page.tsx
const handleAddStudent = async (studentData: StudentFormData) => {
  try {
    const nameParts = studentData.fullName.trim().split(' ');
    const lastName = nameParts[0] || '';
    const firstName = nameParts[1] || '';
    const emailBase = `${firstName.toLowerCase()}.${lastName.toLowerCase()}`.replace(/[^a-z.]/g, '');
    const email = `${emailBase}@lyceum.ru`;
    
    const apiUserData = {
      email: email,
      firstName: firstName,
      lastName: lastName,
      role: 'STUDENT',
      profileData: {
        className: studentData.class,
        cottage: studentData.cottage,
      }
    };

    console.log('–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:', apiUserData);
    await createUser(apiUserData);
    setAddModalOpen(false);
    alert('–°—Ç—É–¥–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—á–µ–Ω–∏–∫–∞:', err);
    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É—á–µ–Ω–∏–∫–∞: ' + (err instanceof Error ? err.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
  }
};
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. **–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π HTML —Ñ–∞–π–ª**
- `test-api.html` - –¥–ª—è –ø—Ä—è–º–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

### 2. **–°–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç**
- `test-student-creation.js` - Puppeteer —Ç–µ—Å—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ UI
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∏ —Ñ–æ—Ä–º

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. **CORS –æ—à–∏–±–∫–∏ –≤ Chrome** - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤** - —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
3. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤** - –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- **Backend**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3001 ‚úÖ
- **Frontend**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3002 ‚úÖ
- **API**: –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ
- **–°—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ**: 7 ‚úÖ
- **–¢–µ—Å—Ç—ã**: –ü—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ ‚úÖ

## üîó –î–æ—Å—Ç—É–ø–Ω—ã–µ URL:

1. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤**: http://localhost:3002/students
2. **API Health**: http://localhost:3001/api/v1/health
3. **API Users**: http://localhost:3001/api/v1/users
4. **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: file:///.../test-api.html
5. **Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:3001/api/docs

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–î–ª—è Chrome**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
3. **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test-api.html –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ API
4. **–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏**: –ó–∞–ø—É—Å–∫–∞–π—Ç–µ test-student-creation.js –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞! 